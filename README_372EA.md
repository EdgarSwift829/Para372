# 372手法改良版EA - 使用説明書

## 概要
このEAは「372手法」（3本のパラボリックSAR）を改良したトレンドフォロー型の自動売買システムです。

## バージョン情報
- **バージョン**: v1.0（試作版）
- **作成日**: 2026年2月16日
- **プラットフォーム**: MetaTrader 5

## 主な特徴

### 1. 基本戦略（372手法）
- 15分足、1時間足、4時間足の3本のパラボリックSARを使用
- 3本すべてのSARが同じ方向を示した時のみエントリー
- ドテン方式（逆シグナルで決済→即座に反対ポジション）

### 2. リスク管理
- **固定リスク**: 口座残高の2%
- **自動ロット調整**: 資金増減に応じて自動計算
- **ATRベースのストップロス**: ボラティリティに応じて自動調整
- **リスクリワード**: 1.5倍（カスタマイズ可能）

### 3. エントリーフィルター
- **マルチタイムフレームトレンドフィルター**: 上位足のトレンド方向を確認
  - 日足トレンドフィルター（デフォルトON）
  - 4時間足・1時間足トレンドフィルター（オプション）

### 4. 停止機能
- **負け後の休止**: 5連敗後に4時間の取引停止（カスタマイズ可能）
- **月末・月初停止**: 流動性低下を回避（オプション）

## インストール方法

### 1. ファイルの配置
```
MetaTrader 5フォルダ/MQL5/Experts/372_Improved_EA.mq5
```

### 2. コンパイル
1. MT5のMetaEditorを開く
2. `372_Improved_EA.mq5`を開く
3. F7キーを押してコンパイル
4. エラーがないことを確認

### 3. チャートに適用
1. MT5で任意の通貨ペアの15分足チャートを開く
2. ナビゲーターウィンドウから`372_Improved_EA`をチャートにドラッグ
3. パラメータを設定
4. 「アルゴリズム取引を許可する」にチェック
5. OKをクリック

## パラメータ設定

### 基本設定
| パラメータ | デフォルト値 | 説明 |
|-----------|------------|------|
| Magic | 20250216 | マジックナンバー（他のEAと区別） |
| RiskPercent | 2.0 | リスク（口座残高の%） |

### パラボリックSAR設定
| パラメータ | デフォルト値 | 説明 |
|-----------|------------|------|
| Step15m | 0.001 | 15分足のステップ値 |
| Step1h | 0.01 | 1時間足のステップ値 |
| Step4h | 0.035 | 4時間足のステップ値 |
| Maximum | 0.2 | 最大値（全時間足共通） |

### SL/TP設定
| パラメータ | デフォルト値 | 説明 |
|-----------|------------|------|
| ATR_Period | 14 | ATR計算期間 |
| ATR_Multiplier | 1.5 | ATR倍率（SL幅の決定） |
| RiskRewardRatio | 1.5 | リスクリワード比率 |

### トレンドフィルター
| パラメータ | デフォルト値 | 説明 |
|-----------|------------|------|
| UseDailyTrend | true | 日足トレンドフィルター使用 |
| Use4HTrend | false | 4時間足トレンドフィルター使用 |
| Use1HTrend | false | 1時間足トレンドフィルター使用 |

### 負け後の休止機能
| パラメータ | デフォルト値 | 説明 |
|-----------|------------|------|
| UseLossBreak | true | 休止機能の有効/無効 |
| LossBreakCount | 5 | 連敗回数のトリガー |
| LossBreakUnit | "Hours" | 単位（Hours/Bars/Days） |
| LossBreakPeriod | 4 | 休止期間 |

### 月末・月初停止
| パラメータ | デフォルト値 | 説明 |
|-----------|------------|------|
| UseMonthEndStart | false | 月末月初停止機能の有効/無効 |

## 推奨設定

### 初心者向け（保守的）
```
RiskPercent = 1.0
UseDailyTrend = true
Use4HTrend = true
UseLossBreak = true
UseMonthEndStart = true
```

### 標準設定
```
RiskPercent = 2.0
UseDailyTrend = true
Use4HTrend = false
UseLossBreak = true
UseMonthEndStart = false
```

### アグレッシブ
```
RiskPercent = 3.0
UseDailyTrend = false
Use4HTrend = false
UseLossBreak = false
UseMonthEndStart = false
```
※ リスクが高くなるため推奨しません

## 運用の流れ

### フェーズ1: デモ運用（3～6ヶ月）
1. デモ口座でEAをテスト
2. バックテスト結果との乖離を確認
3. パラメータの微調整

### フェーズ2: 少額リアル運用
- **開始条件**: デモで6ヶ月連続プラス収支
- **初期資金**: 10万円～
- **月間投資額**: 最大8万円

### フェーズ3: 本格運用
- フォワードテスト成功後
- 資金を段階的に増額

## バックテスト方法

### 1. ストラテジーテスターを開く
- MT5メニュー: 表示 → ストラテジーテスター

### 2. 設定
- **EA**: 372_Improved_EA
- **通貨ペア**: USD/JPY または EUR/USD
- **期間**: 2015年～2024年（10年間推奨）
- **モデル**: 全ティック（最も正確）
- **預金**: 100万円
- **レバレッジ**: 25倍

### 3. 実行
- 「スタート」をクリック
- 結果を確認

### 4. 最適化（オプション）
- パラメータを最適化する場合:
  - ATR_Multiplier: 1.0～3.0
  - RiskRewardRatio: 1.0～2.0
  - Step15m, Step1h, Step4h

## トラブルシューティング

### エラー: 「インジケーターの作成に失敗しました」
**原因**: MT5が必要なデータをダウンロードしていない
**解決策**:
1. 該当する通貨ペアのチャートを開く
2. 1時間足、4時間足のチャートを開いて履歴をダウンロード
3. EAを再起動

### エラー: 「注文が拒否されました」
**原因**: ブローカーの制限またはロットサイズの問題
**解決策**:
1. RiskPercentを下げる（例: 1.0%）
2. 口座残高を確認
3. ブローカーの最小ロットを確認

### ポジションが開かない
**原因**: トレンドフィルターが厳しすぎる
**解決策**:
1. Use4HTrendをfalseに設定
2. Use1HTrendをfalseに設定
3. UseDailyTrendも一時的にfalseにしてテスト

## パフォーマンス目標

### 期待値
- **プロフィットファクター**: 1.3～1.5
- **勝率**: 65～70%
- **最大ドローダウン**: 10%以下

### モニタリング指標
- 月次損益
- 最大ドローダウン
- 連敗回数
- 平均獲得pips

## リスク警告

⚠️ **重要な注意事項**

1. **損失リスク**: 外国為替取引には高いリスクが伴います
2. **過去の実績**: 過去の成績は将来の結果を保証しません
3. **必ずデモテスト**: 実運用前に必ずデモ環境で十分にテストしてください
4. **自己責任**: すべての取引は自己責任で行ってください
5. **余剰資金のみ**: 生活資金では取引しないでください

## 今後の予定

### v2.0で実装予定
- 経済指標フィルター（羊飼いのFXブログ連携）
- ADXフィルター（トレンド強度確認）
- スプレッドフィルター
- 時間帯フィルター

### v3.0で実装予定
- 連勝時のリスク調整
- 最大ドローダウン保護
- 利益の一部出金アラート

## サポート

### 質問・要望
このEAに関する質問や改善要望は、MT5フォーラムまたはコミュニティで共有してください。

### バグ報告
バグを発見した場合は、以下の情報を含めて報告してください:
- MT5のバージョン
- ブローカー名
- 通貨ペア
- エラーメッセージ
- ログファイル

## 参考資料
- 372手法解説: https://note.com/aimjey/n/n71b67986a455
- MT5公式ドキュメント: https://www.mql5.com/ja/docs

## ライセンス
Copyright 2026, Anthropic
個人利用・商用利用可能

---

**最終更新**: 2026年2月16日
**バージョン**: v1.0
